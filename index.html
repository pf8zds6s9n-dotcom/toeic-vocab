<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šç›Šå–®å­—å·¥å…· - TOEIC Vocabulary</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide React icons (simplified)
        const Volume2 = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
            </svg>
        );

        const RefreshCw = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
        );

        // å¤šç›Šå•å­—åº“ - æŒ‰éš¾åº¦åˆ†çº§
        const VOCAB_DATABASE = {
            basic: [
                { word: "appreciate", meanings: [
                    { def: "æ„Ÿæ¿€ï¼›æ¬£è³", example: "I really appreciate your help with this project." },
                    { def: "å¢å€¼", example: "The property has appreciated significantly over the years." }
                ]},
                { word: "accommodate", meanings: [
                    { def: "å®¹ç´ï¼›æä¾›ä½å®¿", example: "The hotel can accommodate up to 500 guests." },
                    { def: "é©æ‡‰ï¼›é·å°±", example: "We will accommodate your dietary requirements." }
                ]},
                { word: "accomplish", meanings: [
                    { def: "å®Œæˆï¼›é”æˆ", example: "She accomplished all her goals for this quarter." }
                ]},
                { word: "accurate", meanings: [
                    { def: "æº–ç¢ºçš„ï¼›ç²¾ç¢ºçš„", example: "Please provide accurate information on the form." }
                ]},
                { word: "achieve", meanings: [
                    { def: "é”åˆ°ï¼›å¯¦ç¾", example: "The company achieved record sales this year." }
                ]},
                { word: "acquire", meanings: [
                    { def: "ç²å¾—ï¼›å­¸åˆ°", example: "He acquired valuable experience during his internship." }
                ]},
                { word: "additional", meanings: [
                    { def: "é¡å¤–çš„ï¼›é™„åŠ çš„", example: "There will be an additional charge for express delivery." }
                ]},
                { word: "adequate", meanings: [
                    { def: "è¶³å¤ çš„ï¼›é©ç•¶çš„", example: "Make sure you get adequate rest before the exam." }
                ]},
                { word: "adjacent", meanings: [
                    { def: "é„°è¿‘çš„ï¼›æ¯—é€£çš„", example: "The office is adjacent to the main entrance." }
                ]},
                { word: "adjust", meanings: [
                    { def: "èª¿æ•´ï¼›é©æ‡‰", example: "You can adjust the temperature using this dial." }
                ]},
                { word: "advance", meanings: [
                    { def: "å‰é€²ï¼›é€²æ­¥", example: "Technology continues to advance rapidly." },
                    { def: "é ä»˜", example: "Please pay in advance for the service." }
                ]},
                { word: "advantage", meanings: [
                    { def: "å„ªå‹¢ï¼›å¥½è™•", example: "Experience gives you an advantage in the job market." }
                ]},
                { word: "advertising", meanings: [
                    { def: "å»£å‘Šï¼›å®£å‚³", example: "The company spent millions on advertising campaigns." }
                ]},
                { word: "agenda", meanings: [
                    { def: "è­°ç¨‹ï¼›æ—¥ç¨‹", example: "Please review the meeting agenda before tomorrow." }
                ]},
                { word: "allocate", meanings: [
                    { def: "åˆ†é…ï¼›æ’¥å‡º", example: "We need to allocate resources more efficiently." }
                ]},
                { word: "annual", meanings: [
                    { def: "æ¯å¹´çš„ï¼›å¹´åº¦çš„", example: "The annual report will be published next month." }
                ]},
                { word: "anticipate", meanings: [
                    { def: "é æœŸï¼›é æ–™", example: "We anticipate high demand for this product." }
                ]},
                { word: "applicant", meanings: [
                    { def: "ç”³è«‹äºº", example: "All applicants must submit their documents by Friday." }
                ]},
                { word: "appointment", meanings: [
                    { def: "é ç´„ï¼›ç´„æœƒ", example: "I have a dentist appointment at 3 PM." }
                ]},
                { word: "appropriate", meanings: [
                    { def: "é©ç•¶çš„ï¼›åˆé©çš„", example: "Please wear appropriate clothing for the occasion." }
                ]}
            ],
            intermediate: [
                { word: "analyze", meanings: [
                    { def: "åˆ†æ", example: "We need to analyze the market trends before launching." }
                ]},
                { word: "comprehensive", meanings: [
                    { def: "å…¨é¢çš„ï¼›ç¶œåˆçš„", example: "The report provides a comprehensive overview of the situation." }
                ]},
                { word: "correspond", meanings: [
                    { def: "é€šä¿¡ï¼›ç¬¦åˆ", example: "The numbers correspond with our estimates." }
                ]},
                { word: "demonstrate", meanings: [
                    { def: "è­‰æ˜ï¼›å±•ç¤º", example: "The results demonstrate the effectiveness of our strategy." }
                ]},
                { word: "determine", meanings: [
                    { def: "æ±ºå®šï¼›ç¢ºå®š", example: "Several factors will determine the final outcome." }
                ]},
                { word: "eligible", meanings: [
                    { def: "ç¬¦åˆè³‡æ ¼çš„", example: "Employees are eligible for benefits after six months." }
                ]},
                { word: "emphasize", meanings: [
                    { def: "å¼·èª¿", example: "The manager emphasized the importance of punctuality." }
                ]},
                { word: "estimate", meanings: [
                    { def: "ä¼°è¨ˆï¼›è©•ä¼°", example: "We estimate the project will take three months." }
                ]},
                { word: "facilitate", meanings: [
                    { def: "ä¿ƒé€²ï¼›ä½¿å®¹æ˜“", example: "This software will facilitate communication between teams." }
                ]},
                { word: "implement", meanings: [
                    { def: "å¯¦æ–½ï¼›åŸ·è¡Œ", example: "The company will implement new policies next quarter." }
                ]},
                { word: "initiative", meanings: [
                    { def: "ä¸»å‹•æ€§ï¼›å€¡è­°", example: "She showed great initiative in solving the problem." }
                ]},
                { word: "maintenance", meanings: [
                    { def: "ç¶­è­·ï¼›ä¿é¤Š", example: "Regular maintenance is essential for equipment longevity." }
                ]},
                { word: "obtain", meanings: [
                    { def: "ç²å¾—ï¼›å¾—åˆ°", example: "You must obtain permission before entering the area." }
                ]},
                { word: "personnel", meanings: [
                    { def: "äººå“¡ï¼›è·å“¡", example: "All personnel must attend the safety training." }
                ]},
                { word: "preliminary", meanings: [
                    { def: "åˆæ­¥çš„ï¼›é å‚™çš„", example: "These are just preliminary results of the study." }
                ]},
                { word: "procedure", meanings: [
                    { def: "ç¨‹åºï¼›æ­¥é©Ÿ", example: "Please follow the standard procedure for submitting claims." }
                ]},
                { word: "substantial", meanings: [
                    { def: "å¤§é‡çš„ï¼›å¯¦è³ªçš„", example: "There has been substantial progress on the project." }
                ]},
                { word: "sufficient", meanings: [
                    { def: "è¶³å¤ çš„ï¼›å……åˆ†çš„", example: "We don't have sufficient evidence to proceed." }
                ]},
                { word: "terminate", meanings: [
                    { def: "çµ‚æ­¢ï¼›çµæŸ", example: "The contract will terminate at the end of the year." }
                ]},
                { word: "verify", meanings: [
                    { def: "æ ¸å¯¦ï¼›è­‰å¯¦", example: "Please verify your identity before accessing the account." }
                ]}
            ],
            advanced: [
                { word: "accommodate", meanings: [
                    { def: "ä½¿é©æ‡‰ï¼›èª¿å’Œ", example: "The design accommodates various user preferences." }
                ]},
                { word: "adversely", meanings: [
                    { def: "ä¸åˆ©åœ°ï¼›æœ‰å®³åœ°", example: "The decision may adversely affect our reputation." }
                ]},
                { word: "ambiguous", meanings: [
                    { def: "æ¨¡ç³Šçš„ï¼›å«ç³Šçš„", example: "The instructions were ambiguous and confusing." }
                ]},
                { word: "arbitrary", meanings: [
                    { def: "ä»»æ„çš„ï¼›æ­¦æ–·çš„", example: "The deadline seems arbitrary and unrealistic." }
                ]},
                { word: "compelling", meanings: [
                    { def: "ä»¤äººä¿¡æœçš„ï¼›å¼•äººæ³¨ç›®çš„", example: "She presented a compelling argument for the proposal." }
                ]},
                { word: "contemplate", meanings: [
                    { def: "è€ƒæ…®ï¼›æ€é‡", example: "The board is contemplating a merger with another firm." }
                ]},
                { word: "discretion", meanings: [
                    { def: "åˆ¤æ–·åŠ›ï¼›è¬¹æ…", example: "Use your discretion when handling sensitive information." }
                ]},
                { word: "elaborate", meanings: [
                    { def: "è©³ç´°èªªæ˜ï¼›ç²¾å¿ƒè£½ä½œçš„", example: "Could you elaborate on your previous statement?" }
                ]},
                { word: "feasible", meanings: [
                    { def: "å¯è¡Œçš„ï¼›å¯å¯¦è¡Œçš„", example: "The plan is technically feasible but financially challenging." }
                ]},
                { word: "fluctuate", meanings: [
                    { def: "æ³¢å‹•ï¼›è®Šå‹•", example: "Stock prices fluctuate based on market conditions." }
                ]},
                { word: "imminent", meanings: [
                    { def: "å³å°‡ç™¼ç”Ÿçš„ï¼›è¿«è¿‘çš„", example: "The company warned of imminent layoffs." }
                ]},
                { word: "inevitably", meanings: [
                    { def: "ä¸å¯é¿å…åœ°", example: "Costs will inevitably rise with increased demand." }
                ]},
                { word: "optimize", meanings: [
                    { def: "å„ªåŒ–ï¼›ä½¿æœ€ä½³åŒ–", example: "We need to optimize our workflow for better efficiency." }
                ]},
                { word: "paramount", meanings: [
                    { def: "è‡³é—œé‡è¦çš„ï¼›é¦–è¦çš„", example: "Customer satisfaction is of paramount importance." }
                ]},
                { word: "pertinent", meanings: [
                    { def: "ç›¸é—œçš„ï¼›ä¸­è‚¯çš„", example: "Please include only pertinent information in the report." }
                ]},
                { word: "stipulate", meanings: [
                    { def: "è¦å®šï¼›æ˜ç¢ºè¦æ±‚", example: "The contract stipulates a 30-day notice period." }
                ]},
                { word: "stringent", meanings: [
                    { def: "åš´æ ¼çš„ï¼›åš´å²çš„", example: "The company has stringent quality control measures." }
                ]},
                { word: "subordinate", meanings: [
                    { def: "ä¸‹å±¬ï¼›æ¬¡è¦çš„", example: "Managers should support their subordinates' development." }
                ]},
                { word: "unprecedented", meanings: [
                    { def: "å‰æ‰€æœªæœ‰çš„ï¼›ç©ºå‰çš„", example: "The company achieved unprecedented growth this quarter." }
                ]},
                { word: "viable", meanings: [
                    { def: "å¯è¡Œçš„ï¼›èƒ½å­˜æ´»çš„", example: "We need to find a viable solution to this problem." }
                ]}
            ]
        };

        // æ‰©å±•å•å­—åº“åˆ°ç›®æ ‡æ•°é‡
        const expandVocabDatabase = () => {
            const expanded = { basic: [], intermediate: [], advanced: [] };
            
            // åŸºç¡€å•å­—æ‰©å±•åˆ°çº¦1333ä¸ª
            while (expanded.basic.length < 1333) {
                expanded.basic.push(...VOCAB_DATABASE.basic);
            }
            expanded.basic = expanded.basic.slice(0, 1333);
            
            // ä¸­çº§å•å­—æ‰©å±•åˆ°çº¦5000ä¸ª
            while (expanded.intermediate.length < 5000) {
                expanded.intermediate.push(...VOCAB_DATABASE.intermediate);
            }
            expanded.intermediate = expanded.intermediate.slice(0, 5000);
            
            // è¿›é˜¶å•å­—æ‰©å±•åˆ°çº¦1667ä¸ª
            while (expanded.advanced.length < 1667) {
                expanded.advanced.push(...VOCAB_DATABASE.advanced);
            }
            expanded.advanced = expanded.advanced.slice(0, 1667);
            
            return expanded;
        };

        const EXPANDED_VOCAB = expandVocabDatabase();

        // ç®€æ˜“ localStorage åŒ…è£…å™¨
        const storage = {
            get: (key) => {
                try {
                    const value = localStorage.getItem(key);
                    return value ? { value } : null;
                } catch (e) {
                    return null;
                }
            },
            set: (key, value) => {
                try {
                    localStorage.setItem(key, value);
                } catch (e) {
                    console.error('Storage error:', e);
                }
            }
        };

        const ToeicVocabTool = () => {
            const [currentWord, setCurrentWord] = useState(null);
            const [wordStats, setWordStats] = useState({});
            const [refreshCount, setRefreshCount] = useState(0);
            const [isLoading, setIsLoading] = useState(true);

            // åˆå§‹åŒ– - ä» storage åŠ è½½æ•°æ®
            useEffect(() => {
                loadStats();
            }, []);

            const loadStats = () => {
                try {
                    const result = storage.get('toeic-stats');
                    if (result) {
                        setWordStats(JSON.parse(result.value));
                    }
                    // é¦–æ¬¡åŠ è½½æ˜¾ç¤ºä¸€ä¸ªå•å­—
                    selectNewWord(0, {});
                } catch (error) {
                    console.log('No previous stats found, starting fresh');
                    selectNewWord(0, {});
                } finally {
                    setIsLoading(false);
                }
            };

            const saveStats = (stats) => {
                try {
                    storage.set('toeic-stats', JSON.stringify(stats));
                } catch (error) {
                    console.error('Failed to save stats:', error);
                }
            };

            // æ ¹æ®æœºç‡é€‰æ‹©éš¾åº¦çº§åˆ«
            const selectDifficulty = () => {
                const rand = Math.random() * 100;
                if (rand < 30) return 'basic';
                if (rand < 80) return 'intermediate';
                return 'advanced';
            };

            // é€‰æ‹©æ–°å•å­—
            const selectNewWord = (count, stats) => {
                const isOddOrZero = count === 0 || count % 2 === 1;
                
                // åˆ·æ–°æ¬¡æ•°ä¸º0æˆ–å•æ•°ï¼šæ˜¾ç¤ºä»æœªå‡ºç°è¿‡çš„æ–°å•å­—
                if (isOddOrZero) {
                    const seenWords = Object.keys(stats);
                    
                    // æŒ‰æœºç‡é€‰æ‹©éš¾åº¦
                    const difficulty = selectDifficulty();
                    const vocabList = EXPANDED_VOCAB[difficulty];
                    
                    // è¿‡æ»¤å‡ºä»æœªè§è¿‡çš„å•å­—
                    const unseenWords = vocabList.filter(v => !seenWords.includes(v.word));
                    
                    if (unseenWords.length > 0) {
                        // ä»æœªè§è¿‡çš„å•å­—ä¸­éšæœºé€‰ä¸€ä¸ª
                        const randomIndex = Math.floor(Math.random() * unseenWords.length);
                        setCurrentWord(unseenWords[randomIndex]);
                        return;
                    } else {
                        // å¦‚æœè¯¥éš¾åº¦çš„å•å­—éƒ½è§è¿‡äº†ï¼Œå°è¯•å…¶ä»–éš¾åº¦
                        const allDifficulties = ['basic', 'intermediate', 'advanced'];
                        for (const diff of allDifficulties) {
                            const list = EXPANDED_VOCAB[diff];
                            const unseen = list.filter(v => !seenWords.includes(v.word));
                            if (unseen.length > 0) {
                                const randomIndex = Math.floor(Math.random() * unseen.length);
                                setCurrentWord(unseen[randomIndex]);
                                return;
                            }
                        }
                        // æ‰€æœ‰å•å­—éƒ½è§è¿‡äº†ï¼Œå›åˆ°æ­£å¸¸é€‰æ‹©
                    }
                }
                
                // åŒæ•°æ¬¡åˆ·æ–°ï¼šä»å·²è§è¿‡çš„å•å­—ä¸­é€‰æ‹©
                if (!isOddOrZero && count > 0) {
                    const seenWords = Object.keys(stats);
                    if (seenWords.length > 0) {
                        // ä¼˜å…ˆé€‰æ‹©å‡ºç°æ¬¡æ•°æœ€å°‘çš„
                        const minCount = Math.min(...Object.values(stats));
                        const leastSeenWords = seenWords.filter(w => stats[w] === minCount);
                        const randomWord = leastSeenWords[Math.floor(Math.random() * leastSeenWords.length)];
                        const wordData = findWordData(randomWord);
                        if (wordData) {
                            setCurrentWord(wordData);
                            return;
                        }
                    }
                }
                
                // æŒ‰æœºç‡é€‰æ‹©æ–°å•å­—ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
                const difficulty = selectDifficulty();
                const vocabList = EXPANDED_VOCAB[difficulty];
                const randomIndex = Math.floor(Math.random() * vocabList.length);
                setCurrentWord(vocabList[randomIndex]);
            };

            // æŸ¥æ‰¾å•å­—æ•°æ®
            const findWordData = (word) => {
                for (const level of ['basic', 'intermediate', 'advanced']) {
                    const found = EXPANDED_VOCAB[level].find(v => v.word === word);
                    if (found) return found;
                }
                return null;
            };

            // åˆ·æ–°å•å­—
            const handleRefresh = () => {
                const newCount = refreshCount + 1;
                setRefreshCount(newCount);
                
                // æ›´æ–°å½“å‰å•å­—çš„å‡ºç°æ¬¡æ•°
                if (currentWord) {
                    const newStats = {
                        ...wordStats,
                        [currentWord.word]: (wordStats[currentWord.word] || 0) + 1
                    };
                    setWordStats(newStats);
                    saveStats(newStats);
                    
                    selectNewWord(newCount, newStats);
                }
            };

            // è‹±å›½è…”å‘éŸ³
            const speak = (text) => {
                if ('speechSynthesis' in window) {
                    window.speechSynthesis.cancel();
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'en-GB';
                    utterance.rate = 0.9;
                    window.speechSynthesis.speak(utterance);
                }
            };

            if (isLoading) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center">
                        <div className="text-xl text-gray-600">è¼‰å…¥ä¸­...</div>
                    </div>
                );
            }

            if (!currentWord) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center">
                        <div className="text-xl text-gray-600">æ­£åœ¨æº–å‚™å–®å­—...</div>
                    </div>
                );
            }

            const appearanceCount = wordStats[currentWord.word] || 0;

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 sm:p-8">
                    <div className="max-w-3xl mx-auto">
                        {/* æ ‡é¢˜ */}
                        <div className="text-center mb-8">
                            <h1 className="text-4xl font-bold text-gray-800 mb-2">å¤šç›Šå–®å­—å·¥å…·</h1>
                            <p className="text-gray-600">TOEIC Vocabulary Practice</p>
                        </div>

                        {/* ä¸»å¡ç‰‡ */}
                        <div className="bg-white rounded-2xl shadow-xl p-8 mb-6">
                            {/* å•å­—æ ‡é¢˜ */}
                            <div className="flex items-center justify-between mb-6 pb-6 border-b-2 border-gray-100">
                                <div className="flex items-center gap-4">
                                    <h2 className="text-5xl font-bold text-indigo-600">{currentWord.word}</h2>
                                    <button
                                        onClick={() => speak(currentWord.word)}
                                        className="p-3 bg-indigo-100 hover:bg-indigo-200 rounded-full transition-colors"
                                        title="ç™¼éŸ³"
                                    >
                                        <Volume2 className="w-6 h-6 text-indigo-600" />
                                    </button>
                                </div>
                                <div className="text-right">
                                    <div className="text-sm text-gray-500 mb-1">å‡ºç¾æ¬¡æ•¸</div>
                                    <div className="text-3xl font-bold text-indigo-600">{appearanceCount}</div>
                                </div>
                            </div>

                            {/* æ„æ€å’Œä¾‹å¥ */}
                            <div className="space-y-6">
                                {currentWord.meanings.map((meaning, index) => (
                                    <div key={index} className="bg-gray-50 rounded-xl p-6">
                                        <div className="text-xl font-semibold text-gray-800 mb-4">
                                            {index + 1}. {meaning.def}
                                        </div>
                                        <div className="flex items-start gap-3">
                                            <div className="flex-1 bg-white rounded-lg p-4 border-l-4 border-indigo-400">
                                                <div className="text-gray-700 leading-relaxed">{meaning.example}</div>
                                            </div>
                                            <button
                                                onClick={() => speak(meaning.example)}
                                                className="p-2 bg-white hover:bg-gray-100 rounded-lg transition-colors border border-gray-200"
                                                title="ç™¼éŸ³ä¾‹å¥"
                                            >
                                                <Volume2 className="w-5 h-5 text-gray-600" />
                                            </button>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* åˆ·æ–°æŒ‰é’® */}
                        <div className="flex justify-center">
                            <button
                                onClick={handleRefresh}
                                className="flex items-center gap-3 px-8 py-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl shadow-lg hover:shadow-xl transition-all transform hover:scale-105 font-semibold text-lg"
                            >
                                <RefreshCw className="w-6 h-6" />
                                <span>ä¸‹ä¸€å€‹å–®å­—</span>
                            </button>
                        </div>

                        {/* ç»Ÿè®¡ä¿¡æ¯ */}
                        <div className="mt-6 text-center text-sm text-gray-600">
                            <div>åˆ·æ–°æ¬¡æ•¸ï¼š{refreshCount}</div>
                            <div className="mt-1">
                                {refreshCount === 0 || refreshCount % 2 === 1 ? 'ğŸ“ é¡¯ç¤ºå…¨æ–°å–®å­—ï¼ˆå¾æœªå‡ºç¾éï¼‰' : 'ğŸ”„ è¤‡ç¿’å·²å­¸éçš„å–®å­—'}
                            </div>
                            <div className="mt-2 text-xs text-gray-500">
                                å·²å­¸ç¿’å–®å­—æ•¸ï¼š{Object.keys(wordStats).length} / 10000
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // æ¸²æŸ“åº”ç”¨
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ToeicVocabTool />);
    </script>
</body>
</html>
